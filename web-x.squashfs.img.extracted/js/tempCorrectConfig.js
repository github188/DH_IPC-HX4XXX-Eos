function NucUploadStatue(a){global._getStatus(a)}var global=null;is_thermalDouble=webApp.CHANNEL_NUMBER>1?1:0;var channel=is_thermalDouble;!function(a){define(function(require,a,b){b.exports=require("jsCore/pageTab")}),define("cor_global",function(require,b,c){var d=require("jsCore/plugin"),e=require("jsCore/PageBase"),f=null;c.exports=e.extend({init:function(){f=this,f._initPtz(),f._initTab(),f.render()},_initPtz:function(){-1===webApp.DeviceType.indexOf("SD")?(f.$("#attr_boat").remove(),f.$("#attr_zf").remove()):(-1!==webApp.DeviceType.indexOf("SD_CA_ICT")?(f.$("#attr_boat").remove(),f.$("#attr_zf").addClass("fn-marl130")):f.$("#attr_boat").show().find("div[command]").mousedown(function(a){var b=f.$(a.target).addClass("mouse-down");return rpc.PTZ.start(b.attr("command"),f.$("#attr_step").val()-0,0,0),!1}).mouseup(function(a){var b=f.$(a.target).removeClass("mouse-down");return rpc.PTZ.stop(b.attr("command"),f.$("#attr_step").val()-0,0,0),!1}).mouseover(function(a){var b=f.$(a.target);return b.parent().addClass("ui-boat-current-"+b.attr("command").toLowerCase()),!1}).mouseout(function(a){var b=f.$(a.target),c=b.attr("command");return b.parent().removeClass("ui-boat-current-"+c.toLowerCase()),b.hasClass("mouse-down")?(b.removeClass("mouse-down"),rpc.PTZ.stop(c,f.$("#attr_step").val()-0,0,0),!1):!1}),webApp.DeviceType.contains("-T")||(a("#set-menu").find('li[category="advanced"]'),a('#set-menu li[category="advanced"] ul li')[3].addClass("fn-hide")),f.$("#attr_zf").show().find("a[command]").mousedown(function(a){var b=f.$(a.currentTarget).addClass("mouse-down");return rpc.PTZ.start(b.attr("command"),f.$("#attr_step").val()-0||5,0,0,0),!1}).mouseup(function(a){var b=f.$(a.currentTarget).removeClass("mouse-down");return rpc.PTZ.stop(b.attr("command"),f.$("#attr_step").val()-0||5,0,0,0),!1}).mouseout(function(a){var b=f.$(a.currentTarget);return b.hasClass("mouse-down")?(b.removeClass("mouse-down"),rpc.PTZ.stop(b.attr("command"),f.$("#attr_step").val()-0||5,0,0,0),!1):!1}))},_initTab:function(){var a=f.$(".u-tab"),b=f.$(".u-tab-content");a.children("li[data-for]").each(function(a,c){var d=f.$(c),e=d.attr("data-for");require.async(e,function(a){d.data("tabInstance",new a({element:b.find("[data-page="+e+"]")}))})}),a.tab({switched:function(b,c){c.from&&(a.children("li[data-for="+c.from+"]").data("tabInstance").leave(),a.children("li[data-for="+c.to+"]").data("tabInstance").render())}})},render:function(){d.cover("#global_video",function(){d.SetRegionNum(0),d.SetModuleMode(1),d.open()})},leave:function(){f.$(".u-tab").children("li.current").data("tabInstance").leave(),d.hide()},destory:function(){f.$(".u-tab").children().each(function(a,b){f.$(b).data("tabInstance").destory()})}}),define("cor_params",function(require,b,c){var d=require("jsCore/pageBase"),e=require("jsCore/rpc"),f=null;c.exports=d.extend({init:function(){f=this,f.bind(),f.render()},bind:function(){f.$("#temp_p_focalLen").numberfield({min:0,max:99,allowDecimal:!0,decimalPrecision:1,allowNegative:!1}),f.$("#temp_p_venderID").numberfield({min:0,max:999,allowDecimal:!1,allowNegative:!1})},render:function(){f._renderElements()},leave:function(){},onRefresh:function(){f._renderElements(!0)},onSave:function(){var b=a("#temp_p_focalLen").numberfield("value"),c=a("#temp_p_venderID").numberfield("value");a("#temp_p_focalLen").numberfield("isCorrect")&&a("#temp_p_venderID").numberfield("isCorrect")?e.ThermographyNuc.setParams(channel,b,c).done(function(a){a.result?(f._refreshTime(),f.tip("success","Operateingsuccess")):f.tip("error","Operateingfailure")}).fail(function(){f.tip("error","Operateingfailure")}):f.tip("error","Operateingfailure")},_renderElements:function(b){e.ThermographyNuc.getCoreExInfo(channel).done(function(c){c.result?(a("#temp_p_sensorW").text(c.params.info.SensorWidth),a("#temp_p_sensorH").text(c.params.info.SensorHeight),a("#temp_p_partN").text(c.params.info.PartNumber),e.ThermographyNuc.getParams(channel).done(function(c){c.result?(a("#temp_p_focalLen").numberfield("value",c.params.info.FocalLength),a("#temp_p_venderID").numberfield("value",c.params.info.VenderID),b&&f.tip("success","Operateingsuccess")):b&&f.tip("error","Operateingfailure")}).fail(function(){f.tip("error","Operateingfailure")})):f.tip("error","Operateingfailure")}).fail(function(){f.tip("error","Operateingfailure")}),f._refreshTime()},_refreshTime:function(){e.ThermographyNuc.getCalibrateCompleteInfo(channel).done(function(b){b.result&&(a("#corr_p_times").text(b.params.info.ExCoreCnt),a("#corr_p_time").text(b.params.info.ExCoreTime))})}})}),define("cor_NUC",function(require,b,c){var d=require("jsCore/pageBase"),e=require("jsCore/rpc"),f=!1,g=!1,h=2,i=null,j=null;c.exports=d.extend({init:function(){j=global=this,$nuc_confirmBox=j.$("#nuc_confirmBox").dialog({confirm:function(){j._saveCorrect()}}).detach().appendTo(document.body),j.bind(),j.render()},bind:function(){a("#nuc_confirmBox").translation(),a("#dahuaNUCLoad").on("change",j._onDahuaUpgradeChange)},render:function(){f=!1,a("#corr_nuc_start").attr("data-for","start").text(tl("Start")),a("#corr_nuc_abort").addClass("disabled").off("click"),e.ThermographyNuc.getLensInfo(channel).done(function(a){a.result&&(i=a.params||{},j._renderElements())}),a("#corr_nuc_state").text(tl("w_NUCstarttip")),j._refreshTime()},leave:function(){f?j.onAbort():(a("#corr_nuc_start").attr("data-for","start").text(tl("Start")).removeClass("disabled").off("click").on("click",function(a){j._startMethodByType(a)}),a("#corr_nuc_save").removeClass("disabled").off("click").on("click",j.onSave),a("#corr_nuc_check").removeClass("disabled").off("click").on("click",j.onCheck),a("#corr_nuc_default").removeClass("disabled").off("click").on("click",j.onDefault),a("#corr_nuc_update").removeClass("disabled").off("click").on("click",j.onUpdate),a("#corr_filebox").show())},onChangeLen:function(){var b=a("#corr_nucLensNum").val()-0;e.ThermographyNuc.setLensId(channel,b).done(function(a){a.result})},onStart:function(a){j._startMethodByType(a)},onSave:function(){$nuc_confirmBox.dialog("show")},onAbort:function(){f=!1,j._disabledALL(),a("#corr_sffc").prop("checked")&&g?(g=!1,e.ThermographyNuc.sffcAbort(channel).done(function(b){b.result&&(a("#corr_nuc_state").text(tl("w_sffcSaveFinish")),j._continueAbort())})):j._continueAbort()},onDefault:function(){e.ThermographyNuc.restoreFactoryGainMap(channel).done(function(b){b.result?(a("#corr_nuc_state").text(""),a("#corr_nuc_start,#corr_nuc_check,#corr_nuc_update").addClass("disabled").off("click"),a("#corr_filebox").hide(),j._getProgress()):j.tip("error","Operateingfailure")})},onUpdate:function(){a("#corr_nuc_state").text(tl("w_updateLimit")),a("#dahuaNUCLoad").val(""),a("#dahuaNUCLoad").trigger("click")},onCheck:function(){j._checkImgUniformity(!0)},_renderElements:function(){var b=i,c="";a("#corr_nucLensNum").empty(),0==b.lensNum&&(b.lensNum=2);for(var d=0;d<b.lensNum;d++)c+="<option value="+d+">"+(d+1)+"</option>";a("#corr_nucLensNum").append(c),a("#corr_nucLensNum").val(b.dftLensId)},_refreshTime:function(){e.ThermographyNuc.getCalibrateCompleteInfo(channel).done(function(b){b.result&&(a("#corr_nuc_times").text(b.params.info.GainMapCnt),a("#corr_nuc_time").text(b.params.info.GainMapTime))})},_doStart:function(){g=!1,j._disabledALL(),a("#corr_nuc_state").text(tl("w_NUCstartWaittip")),a("#corr_nuc_staload").show(),a("#corr_filebox").hide();var b=a("#corr_nucbackup").prop("checked")?1:0;e.ThermographyNuc.start(channel,b).done(function(c){if(c.result){if(f=!0,a("#corr_nucLensNum,#corr_nucbackup").prop("disabled",!0),a("#corr_nuc_abort").removeClass("disabled").off("click").on("click",j.onAbort),a("#corr_nuc_staload").hide(),b){var d,g=function(){a("#corr_nuc_start，#corr_nuc_abort").addClass("disabled").off("click"),a("#corr_nuc_probar").css("visibility","visible"),a("#corr_nuc_state").text(tl("w_NUCprocesstip")),e.ThermographyNuc.getProgress(channel,0).done(function(b){b.result&&(d=b.params.progress,10>d&&(d=10),a("#corr_nuc_process").css("width",251*d/100+"px"),100==d?(a("#corr_nuc_probar").css("visibility","hidden"),a("#corr_nuc_start").removeClass("disabled").off("click").on("click",function(a){j._startMethodByType(a)}),a("#corr_nuc_abort").removeClass("disabled").off("click").on("click",j.onAbort),a("#corr_nuc_state").text(tl("w_NUCprocessSuccess")),j._goonStart.delay(1e3)):g.delay(1e3))})};g()}else j._goonStart();a("#corr_nuc_start").attr("data-for","black1").text(tl("w_black1"))}else a("#corr_nuc_abort").removeClass("disabled").off("click").on("click",j.onAbort),j.onAbort()})},_doBlack1:function(){a("#corr_nuc_start").addClass("disabled").off("click"),e.ThermographyNuc.captureGain(channel,0).done(function(b){b.result?(a("#corr_nuc_start").removeClass("disabled").off("click").on("click",function(a){j._startMethodByType(a)}),1==h||(a("#corr_nuc_start").attr("data-for","black2").text(tl("w_black2")),a("#corr_nuc_state").text(tl("w_NUCcapture2tip")))):j.onAbort()})},_doBlack2:function(){a("#corr_nuc_start,#corr_nuc_abort").addClass("disabled").off("click"),a("#corr_nuc_state").text(tl("w_NUCdoBlack2Waittip")),a("#corr_nuc_staload").show(),e.ThermographyNuc.captureGain(channel,1).done(function(b){b.result?a("#corr_sffc").prop("checked")?j._startSFFC():j._checkImgUniformity():(a("#corr_nuc_abort").removeClass("disabled").off("click").on("click",j.onAbort),j.onAbort())})},_startMethodByType:function(b){if(b&&b.currentTarget){var c=a(b.currentTarget).attr("data-for");switch(c){case"start":j._doStart();break;case"black1":j._doBlack1();break;case"black2":j._doBlack2()}}},_disabledALL:function(){a("#corr_nuc_start,#corr_nuc_abort,#corr_nuc_save,#corr_nuc_check,#corr_nuc_default,#corr_nuc_update").addClass("disabled").off("click")},_goonStart:function(){a("#corr_nuc_start").attr("data-for","black1").text(tl("w_black1")).removeClass("disabled").off("click").on("click",function(a){j._startMethodByType(a)}),a("#corr_nuc_state").text(tl("w_NUCcapture1tip"))},_startSFFC:function(){a("#corr_nuc_state").text(tl("w_nucsffcStart")),a("#corr_nuc_staload").show(),e.ThermographyNuc.sffcStart(channel).done(function(b){b.result?(a("#corr_nuc_state").text(tl("w_nucsffcNext")),e.ThermographyNuc.sffcBlackBody(channel).done(function(b){g=!0,j._checkImgUniformity(),b.result?a("#corr_nuc_staload").hide():j.tip("error","Operateingfailure")})):(a("#corr_nuc_state").text(tl("w_sffcStartFail")),a("#corr_nuc_staload").hide(),j.tip("error","Operateingfailure"),j._continueNuc())})},_continueNuc:function(){a("#corr_nuc_start").attr("data-for","start").text(tl("Start")).addClass("disabled").off("click"),a("#corr_nuc_abort").removeClass("disabled").off("click").on("click",j.onAbort),a("#corr_nuc_save").removeClass("disabled").off("click").on("click",j.onSave),a("#corr_nuc_check").removeClass("disabled").off("click").on("click",j.onCheck),a("#orr_nuc_staload").hide()},_checkImgUniformity:function(b){a("#corr_nuc_state").text(tl("w_checkImgUniformityTips")),e.ThermographyNuc.checkImgUniformity(channel).done(function(c){if(c.result){if(a("#corr_nuc_state").text(c.params.status?1==b?tl("w_checkImgUniformitySuccessTips"):tl("w_checkImgUniformitySuccessTips")+tl("w_NUCsavetip"):1==b?tl("w_checkImgUniformityFailTips"):tl("w_checkImgUniformityFailTips")+tl("w_NUCsavetip")),1==b)return void j.tip("success","Operateingsuccess")}else if(1==b)return void j.tip("error","Operateingfailure");j._continueNuc()})},_continueAbort:function(){a("#corr_nuc_staload").show(),a("#corr_nuc_state").text(tl("w_NUCabortCorrect")),e.ThermographyNuc.abort(channel).done(function(b){b.result&&a("#corr_nuc_start").attr("data-for","start").text(tl("Start")),a("#corr_nucLensNum，#corr_nucbackup").prop("disabled",!1),a("#corr_nuc_start").removeClass("disabled").off("click").on("click",function(a){j._startMethodByType(a)}),a("#corr_nuc_save").removeClass("disabled").off("click").on("click",j.onSave),a("#corr_nuc_check").removeClass("disabled").off("click").on("click",j.onCheck),a("#corr_nuc_staload").hide(),a("#corr_nuc_state").text(tl("w_NUCstarttip")),a("#corr_nuc_update").removeClass("disabled").off("click").on("click",j.onUpdate),a("#corr_nuc_default").removeClass("disabled").off("click").on("click",j.onDefault),a("#corr_filebox").show()})},_getProgress:function(){a("#corr_nuc_probar").css("visibility","visible"),a("#corr_filebox").hide(),j._disabledALL();var b=function(){e.ThermographyNuc.getProgress(channel,1).done(function(c){c.result?(progress=c.params.progress,progress<10&&(progress=10),a("#corr_nuc_process").css("width",251*progress/100+"px"),100==progress?(a("#corr_nucLensNum，#corr_nucbackup").prop("disabled",!1),a("#corr_nuc_start").removeClass("disabled").off("click").on("click",function(a){j._startMethodByType(a)}),a("#corr_nuc_save").removeClass("disabled").off("click").on("click",j.onSave),a("#corr_nuc_check").removeClass("disabled").off("click").on("click",j.onCheck),a("#corr_nuc_probar").css("visibility","hidden"),a("#corr_nuc_update").removeClass("disabled").off("click").on("click",j.onUpdate),a("#corr_nuc_default").removeClass("disabled").off("click").on("click",j.onDefault),a("#corr_filebox").show(),a("#corr_nuc_state").text(tl("w_NUCstarttip")),j.tip("success","Operateingsuccess")):b.delay(1e3)):(a("#corr_nuc_probar").css("visibility","hidden"),a("#corr_filebox").show(),a("#corr_nuc_check").removeClass("disabled").off("click").on("click",j.onCheck),a("#corr_nuc_update").removeClass("disabled").off("click").on("click",j.onUpdate),a("#corr_nuc_default").removeClass("disabled").off("click").on("click",j.onDefault),a("#corr_nuc_start").removeClass("disabled").off("click").on("click",function(a){j._startMethodByType(a)}),a("#corr_nuc_state").text(tl("w_NUCstarttip")),j.tip("error","Operateingfailure"))})};b()},_onDahuaUpgradeChange:function(){var b=this.value.split("\\");a("#corr_nuc_upPath").val(b[b.length-1]),a("#corr_nuc_state").text(tl("w_NUCbackupUploadTips")),j._setImportConfig()},_setImportConfig:function(){var b=a("#corr_nuc_upPath").val();b&&e.ThermographyNuc.restorePrepare(channel,b).done(function(b){if(b.result){if(""===a("#corr_nuc_upPath").val())return;var c=a("#dahuaNUCLoad").val();c.test(".LENS")?(a("#corr_nuc_start,#corr_nuc_check,#corr_nuc_default").addClass("disabled").off("click"),a("#corr_nucLensNum,#corr_nucbackup").prop("disabled",!0),Cookie.write("DhWebClientSessionID",rpcCore.sessionID,{duration:0,path:"/"}),function(){a("#corr_nuc_submit").trigger("click")}.delay(100)):(j.tip("warning","NUCBadfileformat"),a("#corr_nuc_state").text(tl("w_NUCstarttip")))}else a("#corr_nuc_state").text("text",tl("w_NUCstarttip")),j.tip("error","Operateingfailure")})},_saveCorrect:function(){$nuc_confirmBox.dialog("close"),j._disabledALL(),f=!1,a("#corr_sffc").prop("checked")?e.ThermographyNuc.sffcSave(channel).done(function(b){b.result?(a("#corr_nuc_state").text(tl("w_sffcSaveFinish")),j._continueSave()):(a("#corr_nuc_start").attr("data-for","start").text(tl("Start")).removeClass("disabled").off("click").on("click",function(a){j._startMethodByType(a)}),a("#corr_nuc_save").removeClass("disabled").off("click").on("click",j.onSave),a("#corr_nuc_check").removeClass("disabled").off("click").on("click",j.onCheck),a("#corr_nuc_default").removeClass("disabled").off("click").on("click",j.onDefault),a("#corr_nuc_update").removeClass("disabled").off("click").on("click",j.onUpdate),a("#corr_nuc_state").text(tl("w_NUCstarttip")),a("#corr_filebox").show(),j.tip("error","Operateingfailure"))}):j._continueSave()},_continueSave:function(){a("#corr_nuc_staload").show(),a("#corr_nuc_state").text(tl("w_NUCsaveCorrect")),e.ThermographyNuc.saveGainMap(channel).done(function(b){b.result?(j._refreshTime(),j.tip("success","Operateingsuccess")):j.tip("error","Operateingfailure"),a("#corr_nucLensNum,#corr_nucbackup").prop("disabled",!1),a("#corr_nuc_start").attr("data-for","start").removeClass("disabled").off("click").on("click",function(a){j._startMethodByType(a)}),a("#corr_nuc_abort").addClass("disabled").off("click"),a("#corr_nuc_check").removeClass("disabled").off("click").on("click",j.onCheck),a("#corr_nuc_staload").hide(),a("#corr_nuc_state").text(tl("w_NUCstarttip")),a("#corr_nuc_default").removeClass("disabled").off("click").on("click",j.onDefault),a("#corr_nuc_update").removeClass("disabled").off("click").on("click",j.onUpdate),a("#corr_filebox").show()})},_getStatus:function(b){1===b?e.ThermographyNuc.restoreExecute(channel).done(function(b){b.result?j._getProgress():(a("#corr_nuc_start").attr("data-for","start").removeClass("disabled").off("click").on("click",function(a){j._startMethodByType(a)}),a("#corr_nuc_check").removeClass("disabled").off("click").on("click",j.onCheck),a("#corr_nuc_default").removeClass("disabled").off("click").on("click",j.onDefault),a("#corr_nuc_state").text(tl("w_NUCstarttip")))}).fail(function(){a("#corr_nuc_start").attr("data-for","start").removeClass("disabled").off("click").on("click",function(a){j._startMethodByType(a)}),a("#corr_nuc_check").removeClass("disabled").off("click").on("click",j.onCheck),a("#corr_nuc_default").removeClass("disabled").off("click").on("click",j.onDefault),a("#corr_nuc_state").text(tl("w_NUCstarttip")),j.tip("error",tl("w_NUCbackupUploadFail"))}):(a("#corr_nucLensNum,#corr_nucbackup").prop("disabled",!1),a("#corr_nuc_start").attr("data-for","start").removeClass("disabled").off("click").on("click",function(a){j._startMethodByType(a)}),a("#corr_nuc_check").removeClass("disabled").off("click").on("click",j.onCheck),a("#corr_nuc_default").removeClass("disabled").off("click").on("click",j.onDefault),a("#corr_nuc_state").text(tl("w_NUCstarttip")),j.tip("error",tl("w_NUCbackupUploadFail")))}})}),define("cor_SFFC",function(require,b,c){var d=require("jsCore/pageBase"),e=require("jsCore/rpc"),f=null,g=!1,h=null;c.exports=d.extend({init:function(){h=this,h.render()},render:function(){a("#corrSFFC_save,#corrSFFC_abort").addClass("disabled").off("click"),a("#corrSFFC_start").attr("data-for","start").text(tl("Start")),a("#corrSFFC_state").text(tl("w_sffcStart")),e.ThermographyNuc.getLensInfo(channel).done(function(a){a.result&&(f=a.params||{},h._renderElements())})},bind:function(){},leave:function(){g&&h.onAbortSFFC()},onChangeLen:function(){var b=a("#corr_ffcLensNum").val()-0;e.ThermographyNuc.setLensId(channel,b).done(function(a){a.result})},onStartSFFC:function(a){h._startMethodByType(a)},onAbortSFFC:function(b){e.ThermographyNuc.sffcAbort(channel).done(function(c){c.result&&(b||h.tip("success","Operateingsuccess")),a("#corrSFFC_check").removeClass("disabled").off("click").on("click",h.onCheck),a("#corr_SFFC_staload").hide(),a("#corrSFFC_abort,#corrSFFC_save").addClass("disabled").off("click"),a("#corrSFFC_start").attr("data-for","start").text(tl("Start")).removeClass("disabled").off("click").on("click",function(a){h._startMethodByType(a)}),a("#corrSFFC_state").text(tl("w_sffcStart")),g=!1})},onSaveSFFC:function(){a("#corr_SFFC_staload").show(),a("#corrSFFC_state").text(tl("w_sffcSaveWait")),a("#corrSFFC_abort").addClass("disabled").off("click"),e.ThermographyNuc.sffcSave(channel).done(function(b){b.result?(h._refreshTime(),a("#corr_SFFC_staload").hide(),h.tip("success","Operateingsuccess")):h.tip("error","Operateingfailure"),a("#corrSFFC_abort,#corrSFFC_save").addClass("disabled").off("click"),a("#corrSFFC_start").attr("data-for","start").text(tl("Start")).removeClass("disabled").off("click").on("click",function(a){h._startMethodByType(a)}),a("#corrSFFC_check").removeClass("disabled").off("click").on("click",h.onCheck),a("#corrSFFC_state").text(tl("w_sffcStart")),g=!1})},onCheck:function(){h._checkImgUniformity(!0)},_renderElements:function(){var b=f,c="";a("#corr_ffcLensNum").empty(),0==b.lensNum&&(b.lensNum=2);for(var d=0;d<b.lensNum;d++)c+="<option value="+d+">"+(d+1)+"</option>";a("#corr_ffcLensNum").append(c),a("#corr_ffcLensNum").val(b.dftLensId),h._refreshTime()},_refreshTime:function(){e.ThermographyNuc.getCalibrateCompleteInfo(channel).done(function(b){b.result&&(a("#corr_sffc_times").text(b.params.info.SffcCnt),a("#corr_sffc_time").text(b.params.info.SffcTime))})},_startMethodByType:function(b){if(b&&b.currentTarget){var c=a(b.currentTarget).attr("data-for");switch(c){case"start":h._doStart();break;case"next":h._doNext()}}},_doStart:function(){g=!0,a("#corrSFFC_start,#corrSFFC_save,#corrSFFC_check").addClass("disabled").off("click"),a("#corr_SFFC_staload").show(),a("#corrSFFC_state").text(tl("w_sffcStartWait")),e.ThermographyNuc.sffcStart(channel).done(function(b){b.result?(a("#corrSFFC_start").attr("data-for","next").text(tl("w_next")),a("#corrSFFC_abort").removeClass("disabled").off("click").on("click",h.onAbortSFFC),a("#corrSFFC_state").text(tl("w_sffcNext"))):a("#corrSFFC_state").text(tl("w_sffcStartFail")),a("#corr_SFFC_staload").hide(),a("#corrSFFC_start").removeClass("disabled").off("click").on("click",function(a){h._startMethodByType(a)})})},_doNext:function(){a("#corrSFFC_start,#corrSFFC_abort").addClass("disabled").off("click"),a("#corr_SFFC_staload").show(),a("#corrSFFC_state").text(tl("w_sffcNextWait")),e.ThermographyNuc.sffcBlackBody(channel).done(function(b){a("#corrSFFC_start").removeClass("disabled").off("click").on("click",function(a){h._startMethodByType(a)}),b.result?h._checkImgUniformity():(h.onAbortSFFC(!0),h.tip("error","Operateingfailure"))})},_checkImgUniformity:function(b){a("#corrSFFC_state").text(tl("w_checkImgUniformityTips")),e.ThermographyNuc.checkImgUniformity(channel).done(function(c){if(a("#corrSFFC_check").removeClass("disabled").off("click").on("click",h.onCheck),c.result){if(a("#corrSFFC_state").text(c.params.status?1==b?tl("w_checkImgUniformitySuccessTips"):tl("w_checkImgUniformitySuccessTips")+tl("w_sffcNextFinish"):1==b?tl("w_checkImgUniformityFailTips"):tl("w_checkImgUniformityFailTips")+tl("w_sffcNextFinish")),1==b)return void h.tip("success","Operateingsuccess")}else if(1==b)return void h.tip("error","Operateingfailure");h._continueSffc()})},_continueSffc:function(){a("#corrSFFC_start").addClass("disabled").off("click"),a("#corrSFFC_abort").removeClass("disabled").off("click").on("click",h.onAbortSFFC),a("#corrSFFC_save").removeClass("disabled").off("click").on("click",h.onSaveSFFC),a("#corr_SFFC_staload").hide()}})}),define("cor_correct",function(require,b,c){var d=require("jsCore/pageBase"),e=require("jsCore/rpc"),f=null,g=!1,h=2,i={},j=null;c.exports=d.extend({init:function(){j=this,j.render(),j.bind()},bind:function(){a("#corr_win_trans").on("blur",j._judgeValue),a("#corr_win_ref").on("blur",j._judgeValue1)},render:function(b){g=!1,a("#corr_save,#corr_abort").addClass("disabled").off("click"),a("#corr_start").attr("data-for","start").text(tl("Start")),a("#black1_temp_con").hide(),e.RadiometryManager.getRadiometryCalibrationInfo(channel).done(function(a){a.result?(f=a.params||{},j._renderElementsByCaps(),j._renderElements(),1==b&&j.tip("success","Operateingsuccess")):1==b&&j.tip("error","Operateingfailure")}),j._refreshTime()},leave:function(){g&&j.onAbortCorrect()},onChangeLen:function(){for(var b=f,c=a("#corr_LensNum").val()-0,d=0;d<b.info.LensParams.length;d++){var e=b.info.LensParams[d];e.LensId==c&&(a("#corr_lens_F").val(e.LensFNumber),a("#corr_lens_tran").val(e.LensTransmission),i[c][0]=a("#corr_lens_F").val()-0,i[c][1]=a("#corr_lens_tran").val()-0)}},onStartCorrect:function(a){j._startMethodByType(a)},onAbortCorrect:function(){a("#corr_staload").hide(),e.RadiometryManager.abortRadiometryCalibration(channel).done(function(b){b.result&&(a("#corr_start").prop("data-for","start").text(tl("Start")),a("#black1_temp_con").hide()),g=!1}),a("#corr_start").removeClass("disabled").off("click").on("click",j.onStartCorrect),a("#corr_abort,#corr_save").addClass("disabled").off("click"),a("#corr_refresh").removeClass("disabled").off("click").on("click",j.onRefreshCorrect),a("#corr_start_tip").css("visibility","hidden")},onSaveCorrect:function(){e.RadiometryManager.saveRadiometryCalibration(channel).done(function(a){a.result?(j._refreshTime(),j.tip("success","Operateingsuccess")):j.tip("error","Operateingfailure"),g=!1}),a("#corr_start").attr("data-for","start").removeClass("disabled").off("click").on("click",j.onStartCorrect),a("#corr_start_tip").css("visibility","hidden"),a("#corr_abort,#corr_save").addClass("disabled").off("click"),a("corr_refresh").removeClass("disabled").off("click").on("click",j.onRefreshCorrect)},onRefreshCorrect:function(){j.render(!0)},_renderElementsByCaps:function(){var b=f.externalParams;j.$("#corr_lens_F").numberfield({min:0,max:100,allowDecimal:!0,decimalPrecision:2,allowNegative:!1}),j.$("#corr_lens_tran").numberfield({min:0,max:100,allowDecimal:!0,decimalPrecision:2,allowNegative:!1}),j.$("#corr_emissivity").numberfield({min:b.TargetEmissivity.Min,max:b.TargetEmissivity.Max,allowDecimal:!0,decimalPrecision:1,allowNegative:!1}),j.$("#corr_win_trans").numberfield({min:b.WindowTransmission.Min,max:b.WindowTransmission.Max,allowDecimal:!0,decimalPrecision:1,allowNegative:!1}),j.$("#corr_win_temp").numberfield({min:b.WindowTemperature.Min,max:b.WindowTemperature.Max,allowDecimal:!0,decimalPrecision:1,allowNegative:!1}),j.$("#corr_win_ref").numberfield({min:b.WindowReflection.Min,max:b.WindowReflection.Max,allowDecimal:!0,decimalPrecision:1,allowNegative:!1}),j.$("#corr_temp_ref").numberfield({min:b.TemperatureReflectedInWindow.Min,max:b.TemperatureReflectedInWindow.Max,allowDecimal:!0,decimalPrecision:1,allowNegative:!1}),j.$("#corr_back_temp").numberfield({min:b.BackgroundTemperature.Min,max:b.BackgroundTemperature.Max,allowDecimal:!0,decimalPrecision:1,allowNegative:!1}),j.$("#corr_atm_trans").numberfield({min:b.AtmosphericTransmission.Min,max:b.AtmosphericTransmission.Max,allowDecimal:!0,decimalPrecision:1,allowNegative:!1}),j.$("#corr_temp_atm").numberfield({min:b.AtmosphericTemperature.Min,max:b.AtmosphericTemperature.Max,allowDecimal:!0,decimalPrecision:1,allowNegative:!1}),a("#corr_win_trans").on("blur",j._judgeValue),a("#corr_win_ref").on("blur",j._judgeValue1);var c=f.info;a("#corr_sel_gain").empty();for(var d="",e=0;e<c.GainMode.length;e++){var g=c.GainMode[e];d+='<option value="'+g+'">'+tl("w_tempercorrect"+g)+"</option>"}a("#corr_sel_gain").append(d),a("#corr_blackbodies").empty();for(var h="",e=0;e<c.BlackBodyNum;e++)h+="<option value="+(e+1)+">"+(e+1)+"</option>";a("#corr_blackbodies").append(h),a("corr_LensNum").empty();for(var k="",e=0;e<c.LensNum;e++)k+="<option value="+e+">"+(e+1)+"</option>",i[e]=[];a("#corr_LensNum").append(k)},_renderElements:function(){var b=f;a("#corr_sel_gain").val(b.info.DftGainMode),a("#corr_blackbodies").val(b.info.DftBlackBody),a("#corr_LensNum").val(b.info.DftLensId);for(var c=0;c<b.info.LensParams.length;c++){var d=b.info.LensParams[c];d.LensId==b.info.DftLensId&&(a("#corr_lens_F").val(d.LensFNumber.round(2)),a("#corr_lens_tran").val(d.LensTransmission.round(2)),i[a("#corr_LensNum").val()-0][0]=a("#corr_lens_F").val()-0,i[a("#corr_LensNum").val()-0][1]=a("#corr_lens_tran").val()-0)}var e=f.externalParams;a("#corr_emissivity").val(e.TargetEmissivity.Default.round(1)),a("#corr_win_trans").val(e.WindowTransmission.Default.round(1)),a("#corr_back_temp").val(e.BackgroundTemperature.Default.round(1)),a("#corr_win_temp").val(e.WindowTemperature.Default.round(1)),a("#corr_atm_trans").val(e.AtmosphericTransmission.Default.round(1)),a("#corr_win_ref").val(e.WindowReflection.Default.round(1)),a("#corr_temp_ref").val(e.TemperatureReflectedInWindow.Default.round(1)),a("#corr_temp_atm").val(e.AtmosphericTemperature.Default.round(1))},_refreshTime:function(){e.RadiometryManager.getCalibrateCompleteInfo(channel).done(function(b){b.result&&(a("#corr_temp_times").text(b.params.info.RadiometryCnt),a("#corr_temp_time").text(b.params.info.RadiometryTime))})},_judgeValue:function(){a("#corr_win_ref").val(100-(a("#corr_win_trans").val()-0))},_judgeValue1:function(){a("#corr_win_trans").val(100-(a("#corr_win_ref").val()-0))},_startMethodByType:function(b){if(b&&b.currentTarget){var c=a(b.currentTarget).attr("data-for");"start"==c?j._doStart():j._doBlack(c)}},_doStart:function(){g=!0,a("#corr_save,#corr_refresh,#corr_start").addClass("disabled").off("click"),a("#corr_abort").removeClass("disabled").off("click").on("click",j.onAbortCorrect),a("#corr_staload").show();var b={};b.GainMode=a("#corr_sel_gain").val(),h=b.BlackBodyCount=a("#corr_blackbodies").val()-0,b.LensFNumber=a("#corr_lens_F").val()-0,b.LensTransmission=a("#corr_lens_tran").val()-0,b.LensId=a("#corr_LensNum").val()-0,b.ExternalParams={},b.ExternalParams.TargetEmissivity=a("#corr_emissivity").val()-0,b.ExternalParams.WindowTransmission=a("#corr_win_trans").val()-0,b.ExternalParams.WindowTemperature=a("#corr_win_temp").val()-0,b.ExternalParams.WindowReflection=a("#corr_win_ref").val()-0,b.ExternalParams.TemperatureReflectedInWindow=a("#corr_temp_ref").val()-0,b.ExternalParams.BackgroundTemperature=a("#corr_back_temp").val()-0,b.ExternalParams.AtmosphericTransmission=a("#corr_atm_trans").val()-0,b.ExternalParams.AtmosphericTemperature=a("#corr_temp_atm").val()-0,e.RadiometryManager.startRadiometryCalibration(channel,b).done(function(b){b.result&&(a("#black1_temp_con").show(),a("#corr_start").attr("data-for","black_1").text(tl("w_BlackBody")+1).removeClass("disabled").off("click").on("click",j.onStartCorrect),a("#corr_staload").hide(),a("#corr_blackTitle").text(tl("w_BlackBody")+1+tl("w_temperature")),a("#corr_start_tip").css("visibility","visible"))})},_doBlack:function(b){a("#corr_start").addClass("disabled").off("click");var c=a("#black1_temp").val()-0,d=b.split("_")[1]-0;a("#corr_staload").show(),e.RadiometryManager.radiometryCalibration(channel,d-1,c).done(function(b){b.result?(h==d?(a("#corr_start").attr("data-for","start").text(tl("Start")).addClass("disabled").off("click"),a("#black1_temp_con").hide(),a("#corr_save").removeClass("disabled").off("click").on("click",j.onSaveCorrect),a("#corr_refresh").addClass("disabled").off("click"),a("corr_start_tip").css("visibility","hidden")):(d++,a("#corr_start").attr("data-for","black_"+d).text(tl("w_BlackBody")+d).removeClass("disabled").off("click").on("click",j.onStartCorrect),a("#corr_blackTitle").text(tl("w_BlackBody")+d+tl("w_temperature")),a("#black1_temp_con").val("").show()),a("#corr_staload").hide()):j.onAbortCorrect()})}})}),define("cor_point",function(require,b,c){var d=require("jsCore/pageBase"),e=require("jsCore/rpc"),f=!1,g=null;c.exports=d.extend({init:function(){g=this,g.render(),g.bind()},render:function(){a("#corrPoint_start").attr("data-for","start").text(tl("Start")),a("#corrPoint_save,#corrPoint_abort").addClass("disabled").off("click"),a("#corrPoint_state").text(tl("w_pointStart")),g._refreshTime()},bind:function(){},leave:function(){f&&g.onAbortPoint()},onStartPoint:function(){f=!0,a("#corrPoint_start,#corrPoint_save,#corrPoint_default").addClass("disabled").off("click"),a("#corr_corrPoint_staload").show(),a("#corrPoint_state").text(tl("w_pointStartWait")),e.ThermographyNuc.bpcStart(channel).done(function(b){b.result?(a("#corrPoint_abort").removeClass("disabled").off("click").on("click",g.onAbortPoint),a("#corrPoint_save").removeClass("disabled").off("click").on("click",g.onSavePoint),a("#corrPoint_state").text(tl("w_poitNext"))):(a("#corrPoint_start").removeClass("disabled").off("click").on("click",g.onStartPoint),a("#corrPoint_save,#corrPoint_abort").addClass("disabled").off("click"),a("#corrPoint_default").removeClass("disabled").off("click").on("click",g.onDefaultPoint),a("#corrPoint_state").text(tl("w_pointStartFail")),g.tip("error","Operateingfailure")),a("#corr_corrPoint_staload").hide()})},onAbortPoint:function(){e.ThermographyNuc.bpcAbort(channel).done(function(b){b.result?g.tip("success","Operateingsuccess"):g.tip("error","Operateingfailure"),a("#corrPoint_start").removeClass("disabled").off("click").on("click",g.onStartPoint),a("#corrPoint_save,#corrPoint_abort").addClass("disabled").off("click"),a("#corrPoint_default").removeClass("disabled").off("click").on("click",g.onDefaultPoint),a("#corr_corrPoint_staload").hide(),a("#corrPoint_state").text(tl("w_pointStart")),f=!1})},onSavePoint:function(){a("#corr_corrPoint_staload").show(),a("#corrPoint_state").text(tl("w_pointSaveWait")),a("#corrPoint_abort").addClass("disabled").off("click"),e.ThermographyNuc.bpcSave(channel).done(function(b){b.result?(a("#corrPoint_default").removeClass("disabled").off("click").on("click",g.onDefaultPoint),a("#corr_corrPoint_staload").hide(),g._refreshTime(),g.tip("success","Operateingsuccess")):g.tip("error","Operateingfailure"),f=!1,a("#corrPoint_start").removeClass("disabled").off("click").on("click",g.onStartPoint),a("#corrPoint_save,#corrPoint_abort").addClass("disabled").off("click"),a("#corrPoint_state").text(tl("w_pointStart"))
})},onDefaultPoint:function(){e.ThermographyNuc.bpcRestoreFactorySettings(channel).done(function(b){b.result?(g._refreshTime(),g.tip("success","Operateingsuccess")):g.tip("error","Operateingfailure"),a("#corrPoint_save").removeClass("disabled").off("click").on("click",g.onSavePoint)})},_refreshTime:function(){e.ThermographyNuc.getCalibrateCompleteInfo(channel).done(function(b){b.result&&(a("#corrPoint_times").text(b.params.info.BpcCnt),a("#corrPoint_time").text(b.params.info.BpcTime))})}})})})}(jQuery);