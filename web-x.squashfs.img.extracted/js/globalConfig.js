!function(a){define(function(require,a,b){b.exports=require("jsCore/pageTab")}),define("global",function(require,b,c){var d=require("jsCore/rpc"),e=require("jsCore/plugin"),f=require("jsCore/rpcLogin"),g=require("jsCore/PageBase");require("widget/js/dui.slider"),require("widget/js/dui.iconlist"),require("widget/js/dui.iconSelect");var h=null,i=0,j=null;is_thermalDouble=webApp.CHANNEL_NUMBER>1?1:0,c.exports=g.extend({init:function(){h=this,h._initTab(),webApp.CHANNEL_NUMBER>1&&(h.$("#global_channel").parent().removeClass("fn-hide"),j=a("#global_channel").iconSelect({channelNumber:webApp.CHANNEL_NUMBER,allEnable:!1,change:function(b,c){a("#global_tab").children("li").eq(c.ch).trigger("click")}}),j.iconSelect("index",i)),h.render(),e.CheckFuncSupport(2).done(function(b){b?a("#global_fullscreen").show():a("#global_fullscreen").hide()})},_initTab:function(){var a=h.$(".u-tab"),b=h.$(".u-tab-content");h.tabs={},a.tab({switched:function(a,c){var d=h.tabs[c.from],e=h.tabs[c.to];d&&d.leave(),e?(e.render(),h.current=e):require.async(c.to,function(a){h.tabs[c.to]=new a({element:b.find("[data-page="+c.to+"]")}),h.current=h.tabs[c.to]})}})},render:function(){e.cover("#global_video",function(){})},leave:function(){e.hide()},destory:function(){h.$(".u-tab").children().each(function(a,b){h.$(b).data("tabInstance").destory()})}}),define("global_visible",function(require,a,b){var c,h=null,i=0;b.exports=g.extend({init:function(){h=this,h.render()},render:function(){var a="Monitor_0"+(i+1);f.chkAuthority(a)?(e.SetVisibleVideoWnd(1,i),e.ConnectRealVideoEx(i,i,0)):(e.SetVisibleVideoWnd(1,i),e.SetVideoWndTip(i,tl("noVideoAuthoity"))),h._getConfig(!1)},leave:function(){},_renderElements:function(){h.$("#global_hcOn").prop("checked",c[0].HotFollowEnable),h.$("#global_hcOff").prop("checked",!c[0].HotFollowEnable),h.$("#global_temperOn").prop("checked",c[0].RadiometryEnable),h.$("#global_temperOff").prop("checked",!c[0].RadiometryEnable)},onDefault:function(){return d.ConfigManager.getDefault("VisualRadiometry").done(function(a){c=a,h._renderElements(),h.$("#global_tip").tip("success",tl("Defaultsuccess"))}).fail(function(){h.$("#global_tip").tip("error",tl("Defaultsuccess"))}),!1},onRefresh:function(){return h._getConfig(!0),!1},onSave:function(){return c[0].HotFollowEnable=h.$("#global_hcOn").prop("checked"),c[0].RadiometryEnable=h.$("#global_temperOn").prop("checked"),d.ConfigManager.setConfig("VisualRadiometry",c).done(function(){h.$("#global_tip").tip("success",tl("Succeed in saving configure"))}).fail(function(){h.$("#global_tip").tip("error",tl("Saving failure"))}),!1},_getConfig:function(a){d.ConfigManager.getConfig("VisualRadiometry").done(function(b){c=b,h._renderElements(),a&&h.$("#global_tip").tip("success",tl("Operateingsuccess"))}).fail(function(){h.$("#global_tip").tip("error",tl("Operateingfailure"))})}})}),define("global_thermal",function(require,b,c){var h,i,j=null,k=is_thermalDouble;c.exports=g.extend({init:function(){j=this,j.bind()},bind:function(){j.$("#global_temperUnit").change(function(){i.TemperatureUnit=j.$("#global_temperUnit").val();var a=j.$("#global_temperUnit").get(0).selectedIndex;j._onChangeTemperUnit(a,!1)}),j.$("#glo_advance .ui-switch-icon").click(function(){var a=j.$(this).toggleClass("toggle").attr("data-link");new Fx.Slide(a).toggle()}),new Fx.Slide("glo_advancebox").hide()},render:function(){var b="Monitor_0"+(k+1);f.chkAuthority(b)?(e.SetVisibleVideoWnd(1,k),e.ConnectRealVideoEx(k,k,0)):(e.SetVisibleVideoWnd(1,k),e.SetVideoWndTip(k,tl("noVideoAuthoity"))),a.when(d.RadiometryManager.getCaps("All",k),d.ConfigManager.getConfig("HeatImagingThermometry")).done(function(a,b){h=a,i=b,"Fahrenheit"==i.TemperatureUnit?j._onChangeTemperUnit(1,!0):(j._initSlider(),j._renderElements())})},leave:function(){},_initSlider:function(){j.$("[linkSlider][key]").each(function(a,b){var c=j.$(b),d=c.attr("cfg"),e=c.attr("key");c.numberfield({min:j._getConfTable("Caps",e,0),max:j._getConfTable("Caps",e,1),value:j._getConfTable(d,e,0)}).change(function(){c.prev("[slider][key]").slider("value",c.numberfield("value")),j._setConfTable(d,e,0,c.numberfield("value"))})}),j.$("[slider][key]").each(function(a,b){var c=j.$(b),d=c.attr("cfg"),e=c.attr("key");c.slider({min:j._getConfTable("Caps",e,0),max:j._getConfTable("Caps",e,1),step:j._getConfTable("Caps",e,2),change:function(){c.next("[linkSlider][key]").numberfield("value",c.slider("value"))},complete:function(){j._setConfTable(d,e,0,c.slider("value"))}})})},_renderElements:function(){j.$("[slider][key]").each(function(a,b){var c=j.$(b),d=c.attr("cfg"),e=c.attr("key");c.slider("value",j._getConfTable(d,e,0))}),j.$("#global_openTemper").prop("checked",i.TemperEnable),j.$("#global_temperUnit").val(i.TemperatureUnit),j.$("#global_isothermOn").prop("checked",i.Isotherm.Enable),j.$("#global_isothermOff").prop("checked",!i.Isotherm.Enable),j.$("#global_colorCodeOn").prop("checked",i.Isotherm.ColorBarDisplay),j.$("#global_colorCodeOff").prop("checked",!i.Isotherm.ColorBarDisplay)},_onChangeTemperUnit:function(a,b){h.AtmosphericTemperature.Min=j._tansUnit(h.AtmosphericTemperature.Min,a),h.AtmosphericTemperature.Max=j._tansUnit(h.AtmosphericTemperature.Max,a),h.ReflectedTemperature.Min=j._tansUnit(h.ReflectedTemperature.Min,a),h.ReflectedTemperature.Max=j._tansUnit(h.ReflectedTemperature.Max,a),h.MinLimitTemp.Min=j._tansUnit(h.MinLimitTemp.Min,a),h.MinLimitTemp.Max=j._tansUnit(h.MinLimitTemp.Max,a),h.MediumTemp.Min=j._tansUnit(h.MediumTemp.Min,a),h.MediumTemp.Max=j._tansUnit(h.MediumTemp.Max,a),h.MaxLimitTemp.Min=j._tansUnit(h.MaxLimitTemp.Min,a),h.MaxLimitTemp.Max=j._tansUnit(h.MaxLimitTemp.Max,a),h.SaturationTemp.Min=j._tansUnit(h.SaturationTemp.Min,a),h.SaturationTemp.Max=j._tansUnit(h.SaturationTemp.Max,a),b||(i.AtmosphericTemperature=j._tansUnit(i.AtmosphericTemperature,a),i.ReflectedTemperature=j._tansUnit(i.ReflectedTemperature,a),i.Isotherm.MinLimitTemp=j._tansUnit(i.Isotherm.MinLimitTemp,a),i.Isotherm.MediumTemp=j._tansUnit(i.Isotherm.MediumTemp,a),i.Isotherm.MaxLimitTemp=j._tansUnit(i.Isotherm.MaxLimitTemp,a),i.Isotherm.SaturationTemp=j._tansUnit(i.Isotherm.SaturationTemp,a)),j._initSlider(),j._renderElements()},_tansUnit:function(a,b){return b?(9*a/5+32).round(1):(5*(a-32)/9).round(1)},_setConfTable:function(a,b,c,d){var e,f=a.split(".");e=0==c?"Min":1==c?"Max":"Step",1===f.length?"Caps"==a?h[b][e]=d:"Global"==a&&(i[b]=d):2===f.length&&"Global"==f[0]&&(i[f[1]][b]=d)},_needChange:function(){var a=j.$("#global_temperUnit").val();i.TemperatureUnit!=a?"Centigrade"==i.TemperatureUnit?j._onChangeTemperUnit(0,!0):j._onChangeTemperUnit(1,!0):j._renderElements()},_getConfTable:function(a,b,c){var d,e=a.split(".");if(d=0==c?"Min":1==c?"Max":"Step",1===e.length){if("Caps"==a)return h[b][d].round("ObjectEmissivity"==b&&2==c?2:1);if("Global"==a)return"ObjectDistanceMeter"==b?i.ObjectDistance.round(1):i[b].round("ObjectEmissivity"==b?2:1)}else if(2===e.length&&"Global"==e[0])return i[e[1]][b].round(1)},onDefault:function(){return d.ConfigManager.getDefault("HeatImagingThermometry").done(function(a){i=a,j._needChange(),j.$("#global_tip2").tip("success",tl("Defaultsuccess"))}).fail(function(){j.$("#global_tip2").tip("error",tl("Defaultfailure"))}),!1},onRefresh:function(){return d.ConfigManager.getConfig("HeatImagingThermometry").done(function(a){i=a,j._needChange(),j.$("#global_tip2").tip("success",tl("Operateingsuccess"))}).fail(function(){j.$("#global_tip2").tip("error",tl("Operateingfailure"))}),!1},onSave:function(){return j._checkValiable()?(i.TemperEnable=j.$("#global_openTemper").prop("checked"),i.Isotherm.Enable=j.$("#global_isothermOn").prop("checked"),i.Isotherm.ColorBarDisplay=j.$("#global_colorCodeOn").prop("checked"),d.ConfigManager.setConfig("HeatImagingThermometry",i).done(function(){j.$("#global_tip2").tip("success",tl("Succeed in saving configure"))}).fail(function(){j.$("#global_tip2").tip("error",tl("Saving failure"))}),!1):(j.$("#global_tip2").tip("error",tl("w_novaliableValue")),!1)},_checkValiable:function(){var a=i.Isotherm.MinLimitTemp,b=i.Isotherm.MediumTemp,c=i.Isotherm.MaxLimitTemp,d=i.Isotherm.SaturationTemp;return b>=a&&c>=b&&d>=c?!0:!1}})})})}(jQuery);