!function(){define(function(require,a,b){b.exports=require("jsCore/pageTab")}),define("PicInPic",function(require,a,b){var c=require("jsCore/rpc"),d=require("jsCore/pageBase"),e=require("jsCore/plugin"),f=null,g=null,h=null;b.exports=d.extend({init:function(){f=this,f.render()},render:function(){f._getConfig(!1),e.cover("#p_p_video",function(){e.SetIVSDrawingEnable(!1),login.chkAuthority("Monitor_01")?(e.SetVisibleVideoWnd(1,0),e.ConnectRealVideoEx(0,0,0)):(e.SetVisibleVideoWnd(1,0),e.SetVideoWndTip(0,tl("noVideoAuthoity")))}),e.addEvent("VideoAnalyzeConfig",function(a){var b=JSON.decode(a),c=b.ShapeData.LimitRectangleShape;c[1][0]-c[0][0]>2730&&(c[1][0]=c[0][0]+2730),c[1][1]-c[0][1]>3883&&(c[1][1]=c[0][1]+3883),g.Split1[0].SmallPic[0].Position=[],g.Split1[0].SmallPic[0].Position=c[0].concat(c[1])})},leave:function(){e.addEvent("VideoAnalyzeConfig",null),h&&e.DeleteAllIntelShape(h),e.hide()},_renderElements:function(){f.$("#p_p_enable").prop("checked",g.Split1[0].Enable),f._renderPlugin()},_renderPlugin:function(){var a=g.Split1[0].SmallPic[0].Position;if(a&&a.length>0){var b=[],d=[],f=[];d.push(a[0]),d.push(a[1]),b.push(d),f.push(a[2]),f.push(a[3]),b.push(f),info={RectangleShape:b}}else info="";info=JSON.encode(info),e.CreateOneIntelShapeContainer(0,"").done(function(a){h=a,c.ConfigManager.getConfig("Encode").done(function(a){var b=a[0].MainFormat[0].Video,c={limit:[b.Width,b.Height,640,512,320,256]};c=JSON.encode(c),e.CreateOneIntelShape(h,"LimitRectangleShape","VideoAnalyzeConfig","LimitRectangleShape","",info,c).done(function(a){var b=a;e.SetOneIntelShapeThickness(b,2),e.SelectOneIntelShape(b,!1)})})})},onConfirm:function(){g.Split1[0].Enable=f.$("#p_p_enable").prop("checked"),g.Split1[0].SmallPic[0].Enable=!0,c.ConfigManager.setConfig("PicInPic",g).done(function(){f.$("#p_p_tip").tip("success",tl("Succeed in saving configure"))}).fail(function(){f.$("#p_p_tip").tip("error",tl("Saving failure"))})},onRefresh:function(){this._getConfig(!0)},onDefault:function(){c.ConfigManager.getDefault("PicInPic").done(function(a){g=a,f._renderElements(),f.$("#p_p_tip").tip("success",tl("Defaultsuccess"))}).fail(function(){f.$("#p_p_tip").tip("error",tl("Defaultfailure"))})},_getConfig:function(a){c.ConfigManager.getConfig("PicInPic").done(function(b){g=b,f._renderElements(),a&&f.$("#p_p_tip").tip("success",tl("Operateingsuccess"))}).fail(function(){f.$("#p_p_tip").tip("error",tl("Operateingfailure"))})}})})}(jQuery);